#!/bin/bash

# Create a temporary file to capture output
output_file=$(mktemp)

# Function to execute a command and capture its output
execute_command() {
    echo -e "\nCommand: $1" >> "$output_file"
    eval $1 >> "$output_file" 2>&1
}

# Execute each command
execute_command "sudo subscription-manager remove --all"
execute_command "sudo subscription-manager unregister"
execute_command "sudo subscription-manager clean"
execute_command "sudo subscription-manager register --name=\"$(hostname -f)\" --org=\"PLACEHOLDER\" --activationkey=\"PLACEHOLDER\" --force"
execute_command "sudo subscription-manager refresh"
execute_command "sudo subscription-manager repos --enable=\"PLACEHOLDER\""
execute_command "sudo subscription-manager refresh"
execute_command "sudo yum clean all"
execute_command "sudo yum check-update"

# Display the captured output
cat "$output_file"

# Clean up by removing the temporary file
rm "$output_file"
